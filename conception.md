# Концепция 
_Описание частично сгенерировано через Gemini (Увы но я не умею словами что либо понятно передавать), но тем не менее он +- смог передать смысл задумки._

## Личность пользователя

В этом мессенджере у вас нет централизованного аккаунта. Ваша личность — это ваш цифровой паспорт (самоподписанный сертификат).

- __Как это работает:__ Когда вы устанавливаете приложение, оно генерирует два ключа: приватный (_только для вас_) и публичный (_для всех_). Ваш цифровой паспорт — это документ, который подтверждает, что ваш публичный ключ принадлежит вам. Он подписан вашим приватным ключом, поэтому его нельзя подделать.

- __Уникальный ID:__ Ваш адрес в мессенджере — это уникальная ссылка, состоящая из адреса пира (сервера, который вас обслуживает) и вашего отпечатка сертификата (короткого хеша вашего публичного ключа).

  Например: `myprivate.peer.com/a4f5c...`

- __Проверка доверия:__ Когда вы добавляете друга, вы должны убедиться, что его цифровой паспорт настоящий. Для этого вы сверяете короткий 6-значный код, который ваши телефоны генерируют на основе публичных ключей друг друга. Это самый важный шаг, который гарантирует, что вы общаетесь именно с тем человеком, с которым хотите.

## Сеть "Пиров"

Вместо одного центрального сервера, который контролирует всё, сеть состоит из множества независимых серверов, или __пиров__. Любой может запустить свой собственный __пир__.

- __Роль пира:__ Пир — это не хранилище данных, а скорее _телефонная книга_ и временный посредник. Его задача — запомнить ваш отпечаток и ваш IP-адрес, получить сообщение от другого клиента и передать его вам.

- __Взаимодействие:__ Каждый пользователь регистрируется только на одном пире. Но при отправке сообщения, __если второй клиент находится на другом пире__ первый клиент подключится к пиру второго, чтобы передать сообщение.

  _Если ваш пир вышел из строя, вы не можете принимать сообщения, но всё ещё можете их отправлять если второй клиент находится на другом пире._

  __Клиент может получать сообщения только на своем пире.__ _Это не окончательный вердикт, так как можно организовать и подключение к нескольким пирам для получения сообщений, но я пока не представляю как, текущая архитектура намного проще но менее отказоустойчива._

## Безопасность сообщений

Все сообщения защищены сквозным шифрованием, которое обеспечивает полную приватность.

- __Как это работает:__ Когда вы отправляете сообщение, ваш телефон шифрует его публичным ключом вашего друга. После этого сообщение может расшифровать только ваш друг, используя свой приватный ключ. Никто другой, даже пир, не может прочитать, что внутри.

_P.s. Я не сильно разбираюсь в кибербезе, поэтому пока не могу судить насколько это бред, но в теории оно должно работать, и я уже разбираюсь с этим_

## Доставка сообщений

Сообщения могут доставлятся двумя способами:

1. __P2P-соединение:__ Приложение сначала пытается установить прямое P2P-соединение с телефоном друга. Если это удается (например, через UDP Hole Punching), сообщения идут напрямую.

3. __Через сеть пиров:__ Если прямое P2P-соединение невозможно (например, из-за брандмауэра), сообщение отправляется на пир вашего друга. Пир получает его и передает другу. Сообщение остаётся зашифрованным на всём пути.

## Защита данных со стороны пиров

Для защиты данных от несанкционированного доступа (например, от рейда на сервер) все сообщения, которые ждут доставки (и возможно другие данные, например таблицы `fingerprint -> IP`), хранятся только в оперативной памяти. 


